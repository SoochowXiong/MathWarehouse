# ---- 《中国统计图鉴》1978-1998年的统计数据 ----
y <- as.matrix(c(1132.3,1146.4,1159.9,1175.8,1212.3,1367.0,1642.9,2004.8,
                 2122.0,2199.4,2357.2,2664.9,2937.1,3149.5,3483.4,4349.0,
                 5218.1,6242.2,7408.0,8651.1,9876.0))

x <- matrix(c(1018.4,1258.9,1359.4,1545.6,1761.6,1960.8,2295.5,2541.6,
              2763.9,3204.3,3831.0,4228.0,5017.0,5288.6,5800.0,6882.1,
              9457.2,11993.0,13844.2,14211.2,14599.6,
              1607.0,1769.7,1996.5,2048.4,2162.3,2375.6,2789.0,3448.7,
              3967.0,4585.8,5777.2,6484.0,6858.0,8087.1,10284.5,14143.8,
              19359.6,24718.3,29082.6,32412.1,33429.8,
              138.2,143.8,195.5,207.1,220.7,270.6,316.7,417.9,
              525.7,665.8,810.0,794.0,859.4,1015.1,1415.0,2284.7,
              3012.6,3819.6,4530.5,4810.6,5262.0,
              96259,97542,98705,100072,101654,103008,104357,105851,
              107507,109300,111026,112704,114333,115823,117171,118517,
              119850,121121,122389,123626,124810,
              2239.1,2619.4,2976.1,3309.1,3637.9,4020.5,4694.5,5773.0,
              6542.0,7451.2,9360.1,10556.5,11365.2,13145.9,15952.1,20182.1,
              26796.0,33635.0,40003.9,43579.4,46405.9,
              50760,39370,44530,39790,33130,34710,31890,44370,
              47140,42090,50870,46990,38470,55470,51330,48830,
              55040,45821,46989,53429,50145
),nrow=21,ncol=6)

# （1）建立y对x1-x6的线性回归方程 ----
lm5.9 <- lm(y ~ x[,1] + x[,2] +x[,3] +x[,4] +x[,5] +x[,6])
summary(lm5.9)
# 回归方程为y^=1348-0.641x1-0.317x2-0.4125x3-0.002111x4-0.6711x5-0.00752x6。


# （2）用后退法选择自变量 ----
lm5.9.back <- step(lm5.9,direction='backward')
summary(lm5.9.back)

# 后退法剔除P值最大的x3,x4,x6，保留x1,x2,x5作为最终模型，模型的参数均通过显著性检验。
# 得回归方程为到y^=874.60021-0.61119x1-0.35305x2+0.63671x5，
# 模型表明国家财政收入y与农业增加值x1、工业增加值x2、社会消费总额x5有显著线性关系。


# （3）用逐步回归法选择自变量 ----
lm5.9_step <- step(lm5.9,direction='both')
summary(lm5.9_step)
# 得到y^=874.60021-0.61119x1-0.35305x2+0.63671x5，
# 使用step()函数进行逐步回归，其结果与后退法一致。

